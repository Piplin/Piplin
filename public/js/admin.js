var app=app||{};!function(e){e("#group_list table").sortable({containerSelector:"table",itemPath:"> tbody",itemSelector:"tr",placeholder:'<tr class="placeholder"/>',delay:500,onDrop:function(t,a,i){i(t,a);var n=[];e("tbody tr td:first-child",a.el[0]).each(function(t,a){n.push(e(a).data("group-id"))}),e.ajax({url:"/admin/groups/reorder",method:"POST",data:{groups:n}})}}),e("#group").on("show.bs.modal",function(t){var a=e(t.relatedTarget),i=e(this),n=trans("groups.create");e(".btn-danger",i).hide(),e(".callout-danger",i).hide(),e(".has-error",i).removeClass("has-error"),e(".label-danger",i).remove(),a.hasClass("btn-edit")?(n=trans("groups.edit"),e(".btn-danger",i).show()):(e("#group_id").val(""),e("#group_name").val("")),i.find(".modal-title span").text(n)}),e("body").delegate(".group-trash button.btn-delete","click",function(t){var a=e(t.currentTarget),i=a.find("i"),n=a.parents(".modal");i.addClass("ion-refresh fixhub-spin"),n.find("input").attr("disabled","disabled"),e("button.close",n).hide(),app.Groups.get(e("#model_id").val()).destroy({wait:!0,success:function(t,a,s){n.modal("hide"),e(".callout-danger",n).hide(),i.removeClass("ion-refresh fixhub-spin"),e("button.close",n).show(),n.find("input").removeAttr("disabled")},error:function(){i.removeClass("ion-refresh fixhub-spin"),e("button.close",n).show(),n.find("input").removeAttr("disabled")}})}),e("#group button.btn-save").on("click",function(t){var a=e(t.currentTarget),i=a.find("i"),n=a.parents(".modal");i.addClass("ion-refresh fixhub-spin"),n.find("input").attr("disabled","disabled"),e("button.close",n).hide();var s=e("#group_id").val();if(s)var o=app.Groups.get(s);else var o=new app.Group;o.save({name:e("#group_name").val()},{wait:!0,success:function(t,a,o){n.modal("hide"),e(".callout-danger",n).hide(),i.removeClass("ion-refresh fixhub-spin"),e("button.close",n).show(),n.find("input").removeAttr("disabled"),s||app.Groups.add(a)},error:function(t,a,s){e(".callout-danger",n).show();var o=a.responseJSON;e(".has-error",n).removeClass("has-error"),e(".label-danger",n).remove(),e("form input",n).each(function(t,a){a=e(a);var i=a.attr("name");if(void 0!==o[i]){var n=a.parent("div");n.addClass("has-error"),n.append(e("<span>").attr("class","label label-danger").text(o[i]))}}),i.removeClass("ion-refresh fixhub-spin"),e("button.close",n).show(),n.find("input").removeAttr("disabled")}})}),app.Group=Backbone.Model.extend({urlRoot:"/admin/groups",initialize:function(){}});var t=Backbone.Collection.extend({model:app.Group});app.Groups=new t,app.GroupsTab=Backbone.View.extend({el:"#app",events:{},initialize:function(){this.$list=e("#group_list tbody"),e("#group_list").hide(),e("#no_groups").show(),this.listenTo(app.Groups,"add",this.addOne),this.listenTo(app.Groups,"reset",this.addAll),this.listenTo(app.Groups,"remove",this.addAll),this.listenTo(app.Groups,"all",this.render),app.listener.on("group:Fixhub\\Bus\\Events\\ModelChangedEvent",function(t){e("#group_"+t.model.id).html(t.model.name);var a=app.Groups.get(parseInt(t.model.id));a&&a.set(t.model)}),app.listener.on("group:Fixhub\\Bus\\Events\\ModelCreatedEvent",function(e){app.Groups.add(e.model)}),app.listener.on("group:Fixhub\\Bus\\Events\\ModelTrashedEvent",function(t){var a=app.Groups.get(parseInt(t.model.id));a&&app.Groups.remove(a),e("#group_"+t.model.id).parent("li").remove(),parseInt(t.model.id)===parseInt(app.group_id)&&(window.location.href="/")})},render:function(){app.Groups.length?(e("#no_groups").hide(),e("#group_list").show()):(e("#no_groups").show(),e("#group_list").hide())},addOne:function(e){var t=new app.GroupView({model:e});this.$list.append(t.render().el)},addAll:function(){this.$list.html(""),app.Groups.each(this.addOne,this)}}),app.GroupView=Backbone.View.extend({tagName:"tr",events:{"click .btn-edit":"editGroup","click .btn-delete":"trashGroup"},initialize:function(){this.listenTo(this.model,"change",this.render),this.listenTo(this.model,"destroy",this.remove),this.template=_.template(e("#group-template").html())},render:function(){var e=this.model.toJSON();return this.$el.html(this.template(e)),this},editGroup:function(){e("#group_id").val(this.model.id),e("#group_name").val(this.model.get("name"))},trashGroup:function(){var t=e("#model_id");t.val(this.model.id),t.parents(".modal").removeClass().addClass("modal fade group-trash")}})}(jQuery);var app=app||{};!function(e){e("#provider_list table").sortable({containerSelector:"table",itemPath:"> tbody",itemSelector:"tr",placeholder:'<tr class="placeholder"/>',delay:500,onDrop:function(t,a,i){i(t,a);var n=[];e("tbody tr td:first-child",a.el[0]).each(function(t,a){n.push(e(a).data("provider-id"))}),e.ajax({url:"/admin/providers/reorder",method:"POST",data:{providers:n}})}}),e("#provider").on("show.bs.modal",function(t){var a=e(t.relatedTarget),i=e(this),n=trans("providers.create");e(".btn-danger",i).hide(),e(".callout-danger",i).hide(),e(".has-error",i).removeClass("has-error"),e(".label-danger",i).remove(),a.hasClass("btn-edit")?(n=trans("providers.edit"),e(".btn-danger",i).show()):(e("#provider_id").val(""),e("#provider_name").val(""),e("#provider_slug").val(""),e("#provider_icon").val(""),e("#provider_description").val("")),i.find(".modal-title span").text(n)}),e("body").delegate(".provider-trash button.btn-delete","click",function(t){var a=e(t.currentTarget),i=a.find("i"),n=a.parents(".modal");i.addClass("ion-refresh fixhub-spin"),n.find("input").attr("disabled","disabled"),e("button.close",n).hide(),app.Providers.get(e("#model_id").val()).destroy({wait:!0,success:function(t,a,s){n.modal("hide"),e(".callout-danger",n).hide(),i.removeClass("ion-refresh fixhub-spin"),e("button.close",n).show(),n.find("input").removeAttr("disabled")},error:function(){i.removeClass("ion-refresh fixhub-spin"),e("button.close",n).show(),n.find("input").removeAttr("disabled")}})}),e("#provider button.btn-save").on("click",function(t){var a=e(t.currentTarget),i=a.find("i"),n=a.parents(".modal");i.addClass("ion-refresh fixhub-spin"),n.find("input").attr("disabled","disabled"),e("button.close",n).hide();var s=e("#provider_id").val();if(s)var o=app.Providers.get(s);else var o=new app.Provider;o.save({name:e("#provider_name").val(),slug:e("#provider_slug").val(),icon:e("#provider_icon").val(),description:e("#provider_description").val()},{wait:!0,success:function(t,a,o){n.modal("hide"),e(".callout-danger",n).hide(),i.removeClass("ion-refresh fixhub-spin"),e("button.close",n).show(),n.find("input").removeAttr("disabled"),s||app.Providers.add(a)},error:function(t,a,s){e(".callout-danger",n).show();var o=a.responseJSON;e(".has-error",n).removeClass("has-error"),e(".label-danger",n).remove(),e("form input",n).each(function(t,a){a=e(a);var i=a.attr("name");if(void 0!==o[i]){var n=a.parent("div");n.addClass("has-error"),n.append(e("<span>").attr("class","label label-danger").text(o[i]))}}),i.removeClass("ion-refresh fixhub-spin"),e("button.close",n).show(),n.find("input").removeAttr("disabled")}})}),app.Provider=Backbone.Model.extend({urlRoot:"/admin/providers"});var t=Backbone.Collection.extend({model:app.Provider,comparator:function(e,t){return e.get("name")>t.get("name")?-1:e.get("name")<t.get("name")?1:0}});app.Providers=new t,app.ProvidersTab=Backbone.View.extend({el:"#app",events:{},initialize:function(){this.$list=e("#provider_list tbody"),e("#no_providers").show(),e("#provider_list").hide(),this.listenTo(app.Providers,"add",this.addOne),this.listenTo(app.Providers,"reset",this.addAll),this.listenTo(app.Providers,"remove",this.addAll),this.listenTo(app.Providers,"all",this.render),app.listener.on("provider:Fixhub\\Bus\\Events\\ModelChangedEvent",function(e){var t=app.providers.get(parseInt(e.model.id));t&&t.set(e.model)}),app.listener.on("provider:Fixhub\\Bus\\Events\\ModelCreatedEvent",function(e){app.Providers.add(e.model)}),app.listener.on("provider:Fixhub\\Bus\\Events\\ModelTrashedEvent",function(e){var t=app.Providers.get(parseInt(e.model.id));t&&app.Providers.remove(t)})},render:function(){app.Providers.length?(e("#no_providers").hide(),e("#provider_list").show()):(e("#no_providers").show(),e("#provider_list").hide())},addOne:function(t){var a=new app.ProviderView({model:t});this.$list.append(a.render().el),app.Providers.length<2?e(".drag-handle",this.$list).hide():e(".drag-handle",this.$list).show()},addAll:function(){this.$list.html(""),app.Providers.each(this.addOne,this)}}),app.ProviderView=Backbone.View.extend({tagName:"tr",events:{"click .btn-edit":"editProvider","click .btn-delete":"trashProvider"},initialize:function(){this.listenTo(this.model,"change",this.render),this.listenTo(this.model,"destroy",this.remove),this.template=_.template(e("#provider-template").html())},render:function(){var e=this.model.toJSON();return this.$el.html(this.template(e)),this},editProvider:function(){e("#provider_id").val(this.model.id),e("#provider_name").val(this.model.get("name")),e("#provider_slug").val(this.model.get("slug")),e("#provider_icon").val(this.model.get("icon")),e("#provider_description").val(this.model.get("description"))},trashProvider:function(){var t=e("#model_id");t.val(this.model.id),t.parents(".modal").removeClass().addClass("modal fade provider-trash")}})}(jQuery);var app=app||{};!function(e){e("#project-clone").on("show.bs.modal",function(t){var a=e(this);e(".callout-danger",a).hide();var i=e("#skeleton_id").val();e("form",a).prop("action","/admin/projects/"+i+"/clone")}),e("#project-clone button.btn-save").on("click",function(t){var a=e(t.currentTarget);a.find("i"),a.parents(".modal")}),e("#project").on("show.bs.modal",function(t){var a=e(t.relatedTarget),i=e(this),n=trans("projects.create");e(".btn-danger",i).hide(),e(".callout-danger",i).hide(),e(".has-error",i).removeClass("has-error"),e(".label-danger",i).remove(),e("#template-list",i).hide(),e(".nav-tabs a:first",i).tab("show"),a.hasClass("btn-edit")?(n=trans("projects.edit"),e(".btn-danger",i).show()):(e("#template-list",i).show(),e("#project_id").val(""),e("#project_name").val(""),e("#project_repository").val(""),e("#project_branch").val("master"),e("#project_group_id").val(e("#project_group_id option:selected").val()),e("#project_key_id").val(e("#project_key_id option:first").val()),e("#project_builds_to_keep").val(10),e("#project_url").val(""),e("#project_build_url").val(""),e("#project_allow_other_branch").prop("checked",!0),e("#project_need_approve").prop("checked",!1)),i.find(".modal-title span").text(n)}),e("body").delegate(".project-trash button.btn-delete","click",function(t){var a=e(t.currentTarget),i=a.find("i"),n=a.parents(".modal");i.addClass("ion-refresh fixhub-spin"),n.find("input").attr("disabled","disabled"),e("button.close",n).hide(),app.Projects.get(e("#model_id").val()).destroy({wait:!0,success:function(t,a,s){n.modal("hide"),e(".callout-danger",n).hide(),i.removeClass("ion-refresh fixhub-spin"),e("button.close",n).show(),n.find("input").removeAttr("disabled")},error:function(){i.removeClass("ion-refresh fixhub-spin"),e("button.close",n).show(),n.find("input").removeAttr("disabled")}})}),e("#project button.btn-save").on("click",function(t){var a=e(t.currentTarget),i=a.find("i"),n=a.parents(".modal");i.addClass("ion-refresh fixhub-spin"),n.find("input").attr("disabled","disabled"),e("button.close",n).hide();var s=e("#project_id").val();if(s)var o=app.Projects.get(s);else var o=new app.Project;o.save({name:e("#project_name").val(),repository:e("#project_repository").val(),branch:e("#project_branch").val(),group_id:e("#project_group_id").val(),key_id:e("#project_key_id").val(),builds_to_keep:e("#project_builds_to_keep").val(),url:e("#project_url").val(),build_url:e("#project_build_url").val(),template_id:e("#project_template_id")?e("#project_template_id").val():null,allow_other_branch:e("#project_allow_other_branch").is(":checked"),need_approve:e("#project_need_approve").is(":checked")},{wait:!0,success:function(t,a,o){n.modal("hide"),e(".callout-danger",n).hide(),i.removeClass("ion-refresh fixhub-spin"),e("button.close",n).show(),n.find("input").removeAttr("disabled"),s||app.Projects.add(a)},error:function(t,a,s){e(".callout-danger",n).show();var o=a.responseJSON;e(".has-error",n).removeClass("has-error"),e(".label-danger",n).remove(),e("form :input",n).each(function(t,a){a=e(a);var i=a.attr("name");if(void 0!==o[i]){var n=a.parent("div");n.addClass("has-error"),n.append(e("<span>").attr("class","label label-danger").text(o[i]))}}),i.removeClass("ion-refresh fixhub-spin"),e("button.close",n).show(),n.find("input").removeAttr("disabled")}})}),app.Project=Backbone.Model.extend({urlRoot:"/admin/projects"});var t=Backbone.Collection.extend({model:app.Project});app.Projects=new t,app.ProjectsTab=Backbone.View.extend({el:"#app",events:{},initialize:function(){this.$list=e("#project_list tbody"),e("#project_list").hide(),e("#no_projects").show(),this.listenTo(app.Projects,"add",this.addOne),this.listenTo(app.Projects,"reset",this.addAll),this.listenTo(app.Projects,"remove",this.addAll),this.listenTo(app.Projects,"all",this.render),app.listener.on("project:Fixhub\\Bus\\Events\\ModelChangedEvent",function(e){var t=app.Projects.get(parseInt(e.model.id));t&&(void 0==app.group_id||app.group_id==e.model.group_id?t.set(e.model):app.Projects.remove(t))}),app.listener.on("project:Fixhub\\Bus\\Events\\ModelCreatedEvent",function(e){app.Projects.add(e.model)}),app.listener.on("project:Fixhub\\Bus\\Events\\ModelTrashedEvent",function(t){var a=app.Projects.get(parseInt(t.model.id));a&&app.Projects.remove(a),e("#project_"+t.model.id).parent("li").remove(),parseInt(t.model.id)===parseInt(app.project_id)&&(window.location.href="/")})},render:function(){app.Projects.length?(e("#no_projects").hide(),e("#project_list").show()):(e("#no_projects").show(),e("#project_list").hide())},addOne:function(e){var t=new app.ProjectView({model:e});this.$list.append(t.render().el)},addAll:function(){this.$list.html(""),app.Projects.each(this.addOne,this)}}),app.ProjectView=Backbone.View.extend({tagName:"tr",events:{"click .btn-edit":"editProject","click .btn-clone":"cloneProject","click .btn-trash":"trashProject"},initialize:function(){this.listenTo(this.model,"change",this.render),this.listenTo(this.model,"destroy",this.remove),this.template=_.template(e("#project-template").html())},render:function(){var e=this.model.toJSON();return e.deploy=!!e.last_run&&moment(e.last_run).format("YYYY-MM-DD HH:mm:ss"),this.$el.html(this.template(e)),this},editProject:function(){e("#project_id").val(this.model.id),e("#project_name").val(this.model.get("name")),e("#project_repository").val(this.model.get("repository")),e("#project_branch").val(this.model.get("branch")),e("#project_group_id").val(this.model.get("group_id")),e("#project_key_id").val(this.model.get("key_id")),e("#project_builds_to_keep").val(this.model.get("builds_to_keep")),e("#project_url").val(this.model.get("url")),e("#project_build_url").val(this.model.get("build_url")),e("#project_allow_other_branch").prop("checked",!0===this.model.get("allow_other_branch")),e("#project_need_approve").prop("checked",!0===this.model.get("need_approve"))},cloneProject:function(){e("#skeleton_id").val(this.model.id),e("#project_clone_name").val(this.model.get("name")+"_Clone")},trashProject:function(){var t=e("#model_id");t.val(this.model.id),t.parents(".modal").removeClass().addClass("modal fade project-trash")}})}(jQuery);var app=app||{};!function(e){e("#template").on("show.bs.modal",function(t){var a=e(t.relatedTarget),i=e(this),n=trans("templates.create");e(".btn-danger",i).hide(),e(".callout-danger",i).hide(),e(".has-error",i).removeClass("has-error"),e(".label-danger",i).remove(),a.hasClass("btn-edit")?(n=trans("templates.edit"),e(".btn-danger",i).show()):(e("#template_id").val(""),e("#template_name").val("")),i.find(".modal-title span").text(n)}),e("body").delegate(".template-trash button.btn-delete","click",function(t){var a=e(t.currentTarget),i=a.find("i"),n=a.parents(".modal");i.addClass("ion-refresh fixhub-spin"),n.find("input").attr("disabled","disabled"),e("button.close",n).hide(),app.Templates.get(e("#model_id").val()).destroy({wait:!0,success:function(t,a,s){n.modal("hide"),e(".callout-danger",n).hide(),i.removeClass("ion-refresh fixhub-spin"),e("button.close",n).show(),n.find("input").removeAttr("disabled")},error:function(){i.removeClass("ion-refresh fixhub-spin"),e("button.close",n).show(),n.find("input").removeAttr("disabled")}})}),e("#template button.btn-save").on("click",function(t){var a=e(t.currentTarget),i=a.find("i"),n=a.parents(".modal");i.addClass("ion-refresh fixhub-spin"),n.find("input").attr("disabled","disabled"),e("button.close",n).hide();var s=e("#template_id").val();if(s)var o=app.Templates.get(s);else var o=new app.Template;o.save({name:e("#template_name").val()},{wait:!0,success:function(t,a,o){n.modal("hide"),e(".callout-danger",n).hide(),i.removeClass("ion-refresh fixhub-spin"),e("button.close",n).show(),n.find("input").removeAttr("disabled"),s||(app.Templates.add(a),window.location.href="/admin/templates/"+a.id)},error:function(t,a,s){e(".callout-danger",n).show();var o=a.responseJSON;e(".has-error",n).removeClass("has-error"),e(".label-danger",n).remove(),e("form input",n).each(function(t,a){a=e(a);var i=a.attr("name");if(void 0!==o[i]){var n=a.parent("div");n.addClass("has-error"),n.append(e("<span>").attr("class","label label-danger").text(o[i]))}}),i.removeClass("ion-refresh fixhub-spin"),e("button.close",n).show(),n.find("input").removeAttr("disabled")}})}),app.Template=Backbone.Model.extend({urlRoot:"/admin/templates"});var t=Backbone.Collection.extend({model:app.Template});app.Templates=new t,app.TemplatesTab=Backbone.View.extend({el:"#app",events:{},initialize:function(){this.$list=e("#template_list tbody"),e("#template_list").hide(),e("#no_templates").show(),this.listenTo(app.Templates,"add",this.addOne),this.listenTo(app.Templates,"reset",this.addAll),this.listenTo(app.Templates,"remove",this.addAll),this.listenTo(app.Templates,"all",this.render),app.listener.on("template:Fixhub\\Bus\\Events\\ModelChangedEvent",function(e){var t=app.Templates.get(parseInt(e.model.id));t&&t.set(e.model)}),app.listener.on("template:Fixhub\\Bus\\Events\\ModelCreatedEvent",function(e){app.Templates.add(e.model)}),app.listener.on("template:Fixhub\\Bus\\Events\\ModelTrashedEvent",function(e){var t=app.Templates.get(parseInt(e.model.id));t&&app.Templates.remove(t)})},render:function(){app.Templates.length?(e("#no_templates").hide(),e("#template_list").show()):(e("#no_templates").show(),e("#template_list").hide())},addOne:function(e){var t=new app.TemplateView({model:e});this.$list.append(t.render().el)},addAll:function(){this.$list.html(""),app.Templates.each(this.addOne,this)}}),app.TemplateView=Backbone.View.extend({tagName:"tr",events:{"click .btn-edit":"editTemplate","click .btn-delete":"trashTemplate"},initialize:function(){this.listenTo(this.model,"change",this.render),this.listenTo(this.model,"destroy",this.remove),this.template=_.template(e("#template-template").html())},render:function(){var e=this.model.toJSON();return this.$el.html(this.template(e)),this},editTemplate:function(){e("#template_id").val(this.model.id),e("#template_name").val(this.model.get("name"))},trashTemplate:function(){var t=e("#model_id");t.val(this.model.id),t.parents(".modal").removeClass().addClass("modal fade template-trash")}})}(jQuery);var app=app||{};!function(e){e("#link_list table").sortable({containerSelector:"table",itemPath:"> tbody",itemSelector:"tr",placeholder:'<tr class="placeholder"/>',delay:500,onDrop:function(t,a,i){i(t,a);var n=[];e("tbody tr td:first-child",a.el[0]).each(function(t,a){n.push(e(a).data("link-id"))}),e.ajax({url:"/admin/links/reorder",method:"POST",data:{links:n}})}}),e("#link").on("show.bs.modal",function(t){var a=e(t.relatedTarget),i=e(this),n=trans("links.create");e(".btn-danger",i).hide(),e(".callout-danger",i).hide(),e(".has-error",i).removeClass("has-error"),e(".label-danger",i).remove(),a.hasClass("btn-edit")?(n=trans("links.edit"),e(".btn-danger",i).show()):(e("#link_id").val(""),e("#link_title").val(""),e("#link_url").val(""),e("#link_description").val("")),i.find(".modal-title span").text(n)}),e("body").delegate(".link-trash button.btn-delete","click",function(t){var a=e(t.currentTarget),i=a.find("i"),n=a.parents(".modal");i.addClass("ion-refresh fixhub-spin"),n.find("input").attr("disabled","disabled"),e("button.close",n).hide(),app.Links.get(e("#model_id").val()).destroy({wait:!0,success:function(t,a,s){n.modal("hide"),e(".callout-danger",n).hide(),i.removeClass("ion-refresh fixhub-spin"),e("button.close",n).show(),n.find("input").removeAttr("disabled")},error:function(){i.removeClass("ion-refresh fixhub-spin"),e("button.close",n).show(),n.find("input").removeAttr("disabled")}})}),e("#link button.btn-save").on("click",function(t){var a=e(t.currentTarget),i=a.find("i"),n=a.parents(".modal");i.addClass("ion-refresh fixhub-spin"),n.find("input").attr("disabled","disabled"),e("button.close",n).hide();var s=e("#link_id").val();if(s)var o=app.Links.get(s);else var o=new app.Link;o.save({title:e("#link_title").val(),url:e("#link_url").val(),description:e("#link_description").val()},{wait:!0,success:function(t,a,o){n.modal("hide"),e(".callout-danger",n).hide(),i.removeClass("ion-refresh fixhub-spin"),e("button.close",n).show(),n.find("input").removeAttr("disabled"),s||app.Links.add(a)},error:function(t,a,s){e(".callout-danger",n).show();var o=a.responseJSON;e(".has-error",n).removeClass("has-error"),e(".label-danger",n).remove(),e("form input",n).each(function(t,a){a=e(a);var i=a.attr("name");if(void 0!==o[i]){var n=a.parent("div");n.addClass("has-error"),n.append(e("<span>").attr("class","label label-danger").text(o[i]))}}),i.removeClass("ion-refresh fixhub-spin"),e("button.close",n).show(),n.find("input").removeAttr("disabled")}})}),app.Link=Backbone.Model.extend({urlRoot:"/admin/links"});var t=Backbone.Collection.extend({model:app.Link,comparator:function(e,t){return e.get("title")>t.get("title")?-1:e.get("title")<t.get("title")?1:0}});app.Links=new t,app.LinksTab=Backbone.View.extend({el:"#app",events:{},initialize:function(){this.$list=e("#link_list tbody"),e("#no_links").show(),e("#link_list").hide(),this.listenTo(app.Links,"add",this.addOne),this.listenTo(app.Links,"reset",this.addAll),this.listenTo(app.Links,"remove",this.addAll),this.listenTo(app.Links,"all",this.render),app.listener.on("link:Fixhub\\Bus\\Events\\ModelChangedEvent",function(e){var t=app.Links.get(parseInt(e.model.id));t&&t.set(e.model)}),app.listener.on("link:Fixhub\\Bus\\Events\\ModelCreatedEvent",function(e){app.Links.add(e.model)}),app.listener.on("link:Fixhub\\Bus\\Events\\ModelTrashedEvent",function(e){var t=app.Links.get(parseInt(e.model.id));t&&app.Links.remove(t)})},render:function(){app.Links.length?(e("#no_links").hide(),e("#link_list").show()):(e("#no_links").show(),e("#link_list").hide())},addOne:function(t){var a=new app.LinkView({model:t});this.$list.append(a.render().el),app.Links.length<2?e(".drag-handle",this.$list).hide():e(".drag-handle",this.$list).show()},addAll:function(){this.$list.html(""),app.Links.each(this.addOne,this)}}),app.LinkView=Backbone.View.extend({tagName:"tr",events:{"click .btn-edit":"editLink","click .btn-delete":"trashLink"},initialize:function(){this.listenTo(this.model,"change",this.render),this.listenTo(this.model,"destroy",this.remove),this.template=_.template(e("#link-template").html())},render:function(){var e=this.model.toJSON();return this.$el.html(this.template(e)),this},editLink:function(){e("#link_id").val(this.model.id),e("#link_title").val(this.model.get("title")),e("#link_url").val(this.model.get("url")),e("#link_description").val(this.model.get("description"))},trashLink:function(){var t=e("#model_id");t.val(this.model.id),t.parents(".modal").removeClass().addClass("modal fade link-trash")}})}(jQuery);var app=app||{};!function(e){e("#tip_list table").sortable({containerSelector:"table",itemPath:"> tbody",itemSelector:"tr",placeholder:'<tr class="placeholder"/>',delay:500}),e("#tip").on("show.bs.modal",function(t){var a=e(t.relatedTarget),i=e(this),n=trans("tips.create");e(".btn-danger",i).hide(),e(".callout-danger",i).hide(),e(".has-error",i).removeClass("has-error"),e(".label-danger",i).remove(),a.hasClass("btn-edit")?(n=trans("tips.edit"),e(".btn-danger",i).show()):(e("#tip_id").val(""),e("#tip_body").val(""),e("#tip_status").prop("checked",!0)),i.find(".modal-title span").text(n)}),e("body").delegate(".tip-trash button.btn-delete","click",function(t){var a=e(t.currentTarget),i=a.find("i"),n=a.parents(".modal");i.addClass("ion-refresh fixhub-spin"),n.find("input").attr("disabled","disabled"),e("button.close",n).hide(),app.Tips.get(e("#model_id").val()).destroy({wait:!0,success:function(t,a,s){n.modal("hide"),e(".callout-danger",n).hide(),i.removeClass("ion-refresh fixhub-spin"),e("button.close",n).show(),n.find("input").removeAttr("disabled")},error:function(){i.removeClass("ion-refresh fixhub-spin"),e("button.close",n).show(),n.find("input").removeAttr("disabled")}})}),e("#tip button.btn-save").on("click",function(t){var a=e(t.currentTarget),i=a.find("i"),n=a.parents(".modal");i.addClass("ion-refresh fixhub-spin"),n.find("input").attr("disabled","disabled"),e("button.close",n).hide();var s=e("#tip_id").val();if(s)var o=app.Tips.get(s);else var o=new app.Tip;o.save({body:e("#tip_body").val(),status:e("#tip_status").is(":checked")},{wait:!0,success:function(t,a,o){n.modal("hide"),e(".callout-danger",n).hide(),i.removeClass("ion-refresh fixhub-spin"),e("button.close",n).show(),n.find("input").removeAttr("disabled"),s||app.Tips.add(a)},error:function(t,a,s){e(".callout-danger",n).show();var o=a.responseJSON;e(".has-error",n).removeClass("has-error"),e(".label-danger",n).remove(),e("form input",n).each(function(t,a){a=e(a);var i=a.attr("name");if(void 0!==o[i]){var n=a.parent("div");n.addClass("has-error"),n.append(e("<span>").attr("class","label label-danger").text(o[i]))}}),i.removeClass("ion-refresh fixhub-spin"),e("button.close",n).show(),n.find("input").removeAttr("disabled")}})}),app.Tip=Backbone.Model.extend({urlRoot:"/admin/tips"});var t=Backbone.Collection.extend({model:app.Tip,comparator:function(e,t){return e.get("id")>t.get("id")?-1:e.get("id")<t.get("id")?1:0}});app.Tips=new t,app.TipsTab=Backbone.View.extend({el:"#app",events:{},initialize:function(){this.$list=e("#tip_list tbody"),e("#no_tips").show(),e("#tip_list").hide(),this.listenTo(app.Tips,"add",this.addOne),this.listenTo(app.Tips,"reset",this.addAll),this.listenTo(app.Tips,"remove",this.addAll),this.listenTo(app.Tips,"all",this.render),app.listener.on("tip:Fixhub\\Bus\\Events\\ModelChangedEvent",function(e){var t=app.Tips.get(parseInt(e.model.id));t&&t.set(e.model)}),app.listener.on("tip:Fixhub\\Bus\\Events\\ModelCreatedEvent",function(e){app.Tips.add(e.model)}),app.listener.on("tip:Fixhub\\Bus\\Events\\ModelTrashedEvent",function(e){var t=app.Tips.get(parseInt(e.model.id));t&&app.Tips.remove(t)})},render:function(){app.Tips.length?(e("#no_tips").hide(),e("#tip_list").show()):(e("#no_tips").show(),e("#tip_list").hide())},addOne:function(e){var t=new app.TipView({model:e});this.$list.append(t.render().el)},addAll:function(){this.$list.html(""),app.Tips.each(this.addOne,this)}}),app.TipView=Backbone.View.extend({tagName:"tr",events:{"click .btn-show":"showTip","click .btn-edit":"editTip","click .btn-delete":"trashTip"},initialize:function(){this.listenTo(this.model,"change",this.render),this.listenTo(this.model,"destroy",this.remove),this.template=_.template(e("#tip-template").html())},render:function(){var e=this.model.toJSON();return this.$el.html(this.template(e)),this},editTip:function(){e("#tip_id").val(this.model.id),e("#tip_body").val(this.model.get("body")),e("#tip_status").prop("checked",!0===this.model.get("status"))},showTip:function(){var t=this.model.toJSON();e("#tip_preview").html(t.body)},trashTip:function(){var t=e("#model_id");t.val(this.model.id),t.parents(".modal").removeClass().addClass("modal fade tip-trash")}})}(jQuery);var app=app||{};!function(e){e("#key_list table").sortable({containerSelector:"table",itemPath:"> tbody",itemSelector:"tr",placeholder:'<tr class="placeholder"/>',delay:500,onDrop:function(t,a,i){i(t,a);var n=[];e("tbody tr td:first-child",a.el[0]).each(function(t,a){n.push(e(a).data("key-id"))}),e.ajax({url:"/admin/keys/reorder",method:"POST",data:{keys:n}})}}),e("#key").on("show.bs.modal",function(t){var a=e(t.relatedTarget),i=e(this),n=trans("keys.create");e(".btn-danger",i).hide(),e(".callout-danger",i).hide(),e(".has-error",i).removeClass("has-error"),e(".label-danger",i).remove(),a.hasClass("btn-edit")?(n=trans("keys.edit"),e(".btn-danger",i).show()):(e("#key_id").val(""),e("#key_name").val(""),e("#key_private_key").val("")),i.find(".modal-title span").text(n)}),e("body").delegate(".key-trash button.btn-delete","click",function(t){var a=e(t.currentTarget),i=a.find("i"),n=a.parents(".modal");i.addClass("ion-refresh fixhub-spin"),n.find("input").attr("disabled","disabled"),e("button.close",n).hide(),app.Keys.get(e("#model_id").val()).destroy({wait:!0,success:function(t,a,s){n.modal("hide"),e(".callout-danger",n).hide(),i.removeClass("ion-refresh fixhub-spin"),e("button.close",n).show(),n.find("input").removeAttr("disabled")},error:function(){i.removeClass("ion-refresh fixhub-spin"),e("button.close",n).show(),n.find("input").removeAttr("disabled")}})}),e("#key button.btn-save").on("click",function(t){var a=e(t.currentTarget),i=a.find("i"),n=a.parents(".modal");i.addClass("ion-refresh fixhub-spin"),n.find("input").attr("disabled","disabled"),e("button.close",n).hide();var s=e("#key_id").val();if(s)var o=app.Keys.get(s);else var o=new app.Key;o.save({name:e("#key_name").val(),private_key:e("#key_private_key").val()},{wait:!0,success:function(t,a,o){n.modal("hide"),e(".callout-danger",n).hide(),i.removeClass("ion-refresh fixhub-spin"),e("button.close",n).show(),n.find("input").removeAttr("disabled"),s||app.Keys.add(a)},error:function(t,a,s){e(".callout-danger",n).show();var o=a.responseJSON;e(".has-error",n).removeClass("has-error"),e(".label-danger",n).remove(),e("form input",n).each(function(t,a){a=e(a);var i=a.attr("name");if(void 0!==o[i]){var n=a.parent("div");n.addClass("has-error"),n.append(e("<span>").attr("class","label label-danger").text(o[i]))}}),i.removeClass("ion-refresh fixhub-spin"),e("button.close",n).show(),n.find("input").removeAttr("disabled")}})}),app.Key=Backbone.Model.extend({urlRoot:"/admin/keys"});var t=Backbone.Collection.extend({model:app.Key,comparator:function(e,t){return e.get("name")>t.get("name")?-1:e.get("name")<t.get("name")?1:0}});app.Keys=new t,app.KeysTab=Backbone.View.extend({el:"#app",events:{},initialize:function(){this.$list=e("#key_list tbody"),e("#no_keys").show(),e("#key_list").hide(),this.listenTo(app.Keys,"add",this.addOne),this.listenTo(app.Keys,"reset",this.addAll),this.listenTo(app.Keys,"remove",this.addAll),this.listenTo(app.Keys,"all",this.render),app.listener.on("key:Fixhub\\Bus\\Events\\ModelChangedEvent",function(e){var t=app.Keys.get(parseInt(e.model.id));t&&t.set(e.model)}),app.listener.on("key:Fixhub\\Bus\\Events\\ModelCreatedEvent",function(e){app.Keys.add(e.model)}),app.listener.on("key:Fixhub\\Bus\\Events\\ModelTrashedEvent",function(e){var t=app.Keys.get(parseInt(e.model.id));t&&app.Keys.remove(t)})},render:function(){app.Keys.length?(e("#no_keys").hide(),e("#key_list").show()):(e("#no_keys").show(),e("#key_list").hide())},addOne:function(t){var a=new app.KeyView({model:t});this.$list.append(a.render().el),app.Keys.length<2?e(".drag-handle",this.$list).hide():e(".drag-handle",this.$list).show()},addAll:function(){this.$list.html(""),app.Keys.each(this.addOne,this)}}),app.KeyView=Backbone.View.extend({tagName:"tr",events:{"click .btn-show":"showKey","click .btn-edit":"editKey","click .btn-delete":"trashKey"},initialize:function(){this.listenTo(this.model,"change",this.render),
this.listenTo(this.model,"destroy",this.remove),this.template=_.template(e("#key-template").html())},render:function(){var e=this.model.toJSON();return this.$el.html(this.template(e)),this},editKey:function(){e("#key_id").val(this.model.id),e("#key_name").val(this.model.get("name")),e("#key_private_key").val(this.model.get("private_key"))},showKey:function(){var t=this.model.toJSON();e("#log pre").html(t.public_key)},trashKey:function(){var t=e("#model_id");t.val(this.model.id),t.parents(".modal").removeClass().addClass("modal fade key-trash")}})}(jQuery);var app=app||{};!function(e){e("#user").on("show.bs.modal",function(t){var a=e(t.relatedTarget),i=e(this),n=trans("users.create");e(".btn-danger",i).hide(),e(".callout-danger",i).hide(),e(".existing-only",i).hide(),e(".new-only",i).hide(),e(".has-error",i).removeClass("has-error"),e(".label-danger",i).remove(),a.hasClass("btn-edit")?(n=trans("users.edit"),e(".btn-danger",i).show(),e(".existing-only",i).show()):(e("#user_id").val(""),e("#user_name").val(""),e("#user_level").val(e("#user_level option:first").val()),e("#user_nickname").val(""),e("#user_email").val(""),e("#user_password").val(""),e("#user_password_confirmation").val(""),e(".new-only",i).show()),i.find(".modal-title span").text(n)}),e("body").delegate(".user-trash button.btn-delete","click",function(t){var a=e(t.currentTarget),i=a.find("i"),n=a.parents(".modal");i.addClass("ion-refresh fixhub-spin"),n.find("input").attr("disabled","disabled"),e("button.close",n).hide(),app.Users.get(e("#model_id").val()).destroy({wait:!0,success:function(t,a,s){n.modal("hide"),e(".callout-danger",n).hide(),i.removeClass("ion-refresh fixhub-spin"),e("button.close",n).show(),n.find("input").removeAttr("disabled")},error:function(){i.removeClass("ion-refresh fixhub-spin"),e("button.close",n).show(),n.find("input").removeAttr("disabled")}})}),e("#user button.btn-save").on("click",function(t){var a=e(t.currentTarget),i=a.find("i"),n=a.parents(".modal");i.addClass("ion-refresh fixhub-spin"),n.find("input").attr("disabled","disabled"),e("button.close",n).hide();var s=e("#user_id").val();if(s)var o=app.Users.get(s);else var o=new app.User;o.save({name:e("#user_name").val(),level:e("#user_level").val(),nickname:e("#user_nickname").val(),email:e("#user_email").val(),password:e("#user_password").val(),password_confirmation:e("#user_password_confirmation").val()},{wait:!0,success:function(t,a,o){n.modal("hide"),e(".callout-danger",n).hide(),i.removeClass("ion-refresh fixhub-spin"),e("button.close",n).show(),n.find("input").removeAttr("disabled"),s||app.Users.add(a)},error:function(t,a,s){e(".callout-danger",n).show();var o=a.responseJSON;e(".has-error",n).removeClass("has-error"),e(".label-danger",n).remove(),e("form input",n).each(function(t,a){a=e(a);var i=a.attr("name");if(void 0!==o[i]){var n=a.parent("div");n.addClass("has-error"),n.append(e("<span>").attr("class","label label-danger").text(o[i]))}}),i.removeClass("ion-refresh fixhub-spin"),e("button.close",n).show(),n.find("input").removeAttr("disabled")}})}),app.User=Backbone.Model.extend({urlRoot:"/admin/users",initialize:function(){}});var t=Backbone.Collection.extend({model:app.User});app.Users=new t,app.UsersTab=Backbone.View.extend({el:"#app",events:{},initialize:function(){this.$list=e("#user_list tbody"),this.listenTo(app.Users,"add",this.addOne),this.listenTo(app.Users,"reset",this.addAll),this.listenTo(app.Users,"remove",this.addAll),this.listenTo(app.Users,"all",this.render),app.listener.on("user:Fixhub\\Bus\\Events\\ModelChangedEvent",function(e){var t=app.Users.get(parseInt(e.model.id));t&&t.set(e.model)}),app.listener.on("user:Fixhub\\Bus\\Events\\ModelCreatedEvent",function(e){app.Users.add(e.model)}),app.listener.on("user:Fixhub\\Bus\\Events\\ModelTrashedEvent",function(e){var t=app.Users.get(parseInt(e.model.id));t&&app.Users.remove(t)})},addOne:function(e){var t=new app.UserView({model:e});this.$list.append(t.render().el)},addAll:function(){this.$list.html(""),app.Users.each(this.addOne,this)}}),app.UserView=Backbone.View.extend({tagName:"tr",events:{"click .btn-edit":"editUser","click .btn-delete":"trashUser"},initialize:function(){this.listenTo(this.model,"change",this.render),this.listenTo(this.model,"destroy",this.remove),this.template=_.template(e("#user-template").html())},render:function(){var e=this.model.toJSON();return e.created=moment(e.created_at).format("YYYY-MM-DD HH:mm:ss"),this.$el.html(this.template(e)),this},editUser:function(){e("#user_id").val(this.model.id),e("#user_name").val(this.model.get("name")),e("#user_level").val(this.model.get("level")),e("#user_nickname").val(this.model.get("nickname")),e("#user_email").val(this.model.get("email"))},trashUser:function(){var t=e("#model_id");t.val(this.model.id),t.parents(".modal").removeClass().addClass("modal fade user-trash")}})}(jQuery);var app=app||{};!function(e){e(".command-list table").sortable({containerSelector:"table",itemPath:"> tbody",itemSelector:"tr",placeholder:'<tr class="placeholder"/>',delay:500,onDrop:function(t,a,i){i(t,a);var n=[];e("tbody tr td:first-child",a.el[0]).each(function(t,a){n.push(e(a).data("command-id"))}),e.ajax({url:"/commands/reorder",method:"POST",data:{commands:n}})}});var t;e("#command").on("hidden.bs.modal",function(e){t.destroy()}),e("#command").on("show.bs.modal",function(a){var i=e(a.relatedTarget),n=e(this),s=trans("commands.create");t=ace.edit("command_script"),t.getSession().setMode("ace/mode/sh"),e(".btn-danger",n).hide(),e(".callout-danger",n).hide(),e(".has-error",n).removeClass("has-error"),e(".label-danger",n).remove(),i.hasClass("btn-edit")?(s=trans("commands.edit"),e(".btn-danger",n).show()):(e("#command_id").val(""),e("#command_step").val(i.data("step")),e("#command_name").val(""),t.setValue(""),t.gotoLine(1),e("#command_user").val(""),e("#command_optional").prop("checked",!1),e("#command_default_on").prop("checked",!1),e("#command_default_on_row").addClass("hide"),e(".command-server").prop("checked",!0),e(".command-environment").prop("checked",!0)),n.find(".modal-title span").text(s)}),e("body").delegate(".command-trash button.btn-delete","click",function(t){var a=e(t.currentTarget),i=a.find("i"),n=a.parents(".modal");i.addClass("ion-refresh fixhub-spin"),n.find("input").attr("disabled","disabled"),e("button.close",n).hide(),app.Commands.get(e("#model_id").val()).destroy({wait:!0,success:function(t,a,s){n.modal("hide"),e(".callout-danger",n).hide(),i.removeClass("ion-refresh fixhub-spin"),e("button.close",n).show(),n.find("input").removeAttr("disabled")},error:function(){i.removeClass("ion-refresh fixhub-spin"),e("button.close",n).show(),n.find("input").removeAttr("disabled")}})}),e("#command_optional").on("change",function(t){e("#command_default_on_row").addClass("hide"),!0===e(this).is(":checked")&&e("#command_default_on_row").removeClass("hide")}),e("#command button.btn-save").on("click",function(a){var i=e(a.currentTarget),n=i.find("i"),s=i.parents(".modal");n.addClass("ion-refresh fixhub-spin"),s.find(":input").attr("disabled","disabled"),e("button.close",s).hide();var o=e("#command_id").val();if(o)var r=app.Commands.get(o);else var r=new app.Command;var l=[];e(".command-server:checked").each(function(){l.push(e(this).val())});var d=[];e(".command-environment:checked").each(function(){d.push(e(this).val())}),r.save({name:e("#command_name").val(),script:t.getValue(),user:e("#command_user").val(),step:e("#command_step").val(),targetable_type:e('input[name="targetable_type"]').val(),targetable_id:e('input[name="targetable_id"]').val(),environments:d,optional:e("#command_optional").is(":checked"),default_on:e("#command_default_on").is(":checked")},{wait:!0,success:function(a,i,r){s.modal("hide"),e(".callout-danger",s).hide(),n.removeClass("ion-refresh fixhub-spin"),e("button.close",s).show(),s.find(":input").removeAttr("disabled"),o||app.Commands.add(i),t.setValue(""),t.gotoLine(1)},error:function(t,a,i){e(".callout-danger",s).show();var o=a.responseJSON;e(".has-error",s).removeClass("has-error"),e(".label-danger",s).remove(),e("form input",s).each(function(t,a){a=e(a);var i=a.attr("name");if(void 0!==o[i]){var n=a.parent("div");n.addClass("has-error"),n.append(e("<span>").attr("class","label label-danger").text(o[i]))}}),n.removeClass("ion-refresh fixhub-spin"),e("button.close",s).show(),s.find(":input").removeAttr("disabled")}})}),app.Command=Backbone.Model.extend({urlRoot:"/commands",defaults:function(){return{order:app.Commands.nextOrder()}},isAfter:function(){return parseInt(this.get("step"))%3==0}});var a=Backbone.Collection.extend({model:app.Command,comparator:"order",nextOrder:function(){return this.length?this.last().get("order")+1:1}});app.Commands=new a,app.CommandsTab=Backbone.View.extend({el:"#app",events:{},initialize:function(){this.$beforeList=e("#commands-before .command-list tbody"),this.$afterList=e("#commands-after .command-list tbody"),e(".no-commands").show(),e(".command-list").hide(),this.listenTo(app.Commands,"add",this.addOne),this.listenTo(app.Commands,"reset",this.addAll),this.listenTo(app.Commands,"remove",this.addAll),this.listenTo(app.Commands,"all",this.render),app.listener.on("command:Fixhub\\Bus\\Events\\ModelChangedEvent",function(e){var t=app.Commands.get(parseInt(e.model.id));t&&t.set(e.model)}),app.listener.on("command:Fixhub\\Bus\\Events\\ModelCreatedEvent",function(t){var a=e('input[name="targetable_type"]').val(),i=e('input[name="targetable_id"]').val();a==t.model.targetable_type&&parseInt(t.model.targetable_id)===parseInt(i)&&(parseInt(t.model.step)+1!==parseInt(app.command_action)&&parseInt(t.model.step)-1!==parseInt(app.command_action)||app.Commands.add(t.model))}),app.listener.on("command:Fixhub\\Bus\\Events\\ModelTrashedEvent",function(e){var t=app.Commands.get(parseInt(e.model.id));t&&app.Commands.remove(t)})},render:function(){void 0!==app.Commands.find(function(e){return!e.isAfter()})?(e("#commands-before .no-commands").hide(),e("#commands-before .command-list").show()):(e("#commands-before .no-commands").show(),e("#commands-before .command-list").hide()),void 0!==app.Commands.find(function(e){return e.isAfter()})?(e("#commands-after .no-commands").hide(),e("#commands-after .command-list").show()):(e("#commands-after .no-commands").show(),e("#commands-after .command-list").hide())},addOne:function(t){var a=new app.CommandView({model:t});t.isAfter()?(this.$afterList.append(a.render().el),e("tr",this.$afterList).length<2?e(".drag-handle",this.$afterList).hide():e(".drag-handle",this.$afterList).show()):(this.$beforeList.append(a.render().el),e("tr",this.$beforeList).length<2?e(".drag-handle",this.$beforeList).hide():e(".drag-handle",this.$beforeList).show())},addAll:function(){this.$beforeList.html(""),this.$afterList.html(""),app.Commands.each(this.addOne,this)}}),app.CommandView=Backbone.View.extend({tagName:"tr",events:{"click .btn-edit":"edit","click .btn-delete":"trash"},initialize:function(){this.listenTo(this.model,"change",this.render),this.listenTo(this.model,"destroy",this.remove),this.template=_.template(e("#command-template").html())},render:function(){var e=this.model.toJSON();return this.$el.html(this.template(e)),this},edit:function(){e("#command_id").val(this.model.id),e("#command_step").val(this.model.get("step")),e("#command_name").val(this.model.get("name")),e("#command_script").text(this.model.get("script")),e("#command_user").val(this.model.get("user")),e("#command_optional").prop("checked",!0===this.model.get("optional")),e("#command_default_on").prop("checked",!0===this.model.get("default_on")),e("#command_default_on_row").addClass("hide"),!0===this.model.get("optional")&&e("#command_default_on_row").removeClass("hide"),e(".command-environment").prop("checked",!1),e(this.model.get("environments")).each(function(t,a){e("#command_environment_"+a.id).prop("checked",!0)})},trash:function(){var t=e("#model_id");t.val(this.model.id),t.parents(".modal").removeClass().addClass("modal fade command-trash")}})}(jQuery);var app=app||{};!function(e){var t,a;e("#configfile, #view-configfile").on("hidden.bs.modal",function(e){t.destroy()}),e("#view-configfile").on("show.bs.modal",function(e){t=ace.edit("preview-content"),t.setReadOnly(!0),t.getSession().setUseWrapMode(!0);var i=a.substr(a.lastIndexOf(".")+1).toLowerCase();"php"===i||"ini"===i?t.getSession().setMode("ace/mode/"+i):"yml"===i&&t.getSession().setMode("ace/mode/yaml")}),e("#configfile").on("show.bs.modal",function(a){var i=e(a.relatedTarget),n=e(this),s=trans("configFiles.create");t=ace.edit("content");var o=e("#path").val(),r=o.substr(o.lastIndexOf(".")+1).toLowerCase();"php"===r||"ini"===r?t.getSession().setMode("ace/mode/"+r):"yml"===r&&t.getSession().setMode("ace/mode/yaml"),e(".btn-danger",n).hide(),e(".callout-danger",n).hide(),e(".has-error",n).removeClass("has-error"),e(".label-danger",n).remove(),i.hasClass("btn-edit")?(s=trans("configFiles.edit"),e(".btn-danger",n).show()):(e("#file_id").val(""),e("#name").val(""),e("#path").val(""),t.setValue(""),t.gotoLine(1)),n.find(".modal-title span").text(s)}),e("body").delegate(".configfile-trash button.btn-delete","click",function(t){var a=e(t.currentTarget),i=a.find("i"),n=a.parents(".modal");i.addClass("ion-refresh fixhub-spin"),n.find("input").attr("disabled","disabled"),e("button.close",n).hide(),app.ConfigFiles.get(e("#model_id").val()).destroy({wait:!0,success:function(t,a,s){n.modal("hide"),e(".callout-danger",n).hide(),i.removeClass("ion-refresh fixhub-spin"),e("button.close",n).show(),n.find("input").removeAttr("disabled")},error:function(){i.removeClass("ion-refresh fixhub-spin"),e("button.close",n).show(),n.find("input").removeAttr("disabled")}})}),e("#configfile button.btn-save").on("click",function(a){var i=e(a.currentTarget),n=i.find("i"),s=i.parents(".modal");n.addClass("ion-refresh fixhub-spin"),s.find("input").attr("disabled","disabled"),e("button.close",s).hide();var o=e("#config_file_id").val();if(o)var r=app.ConfigFiles.get(o);else var r=new app.ConfigFile;r.save({name:e("#name").val(),path:e("#path").val(),targetable_type:e('input[name="targetable_type"]').val(),targetable_id:e('input[name="targetable_id"]').val(),content:t.getValue()},{wait:!0,success:function(a,i,r){s.modal("hide"),e(".callout-danger",s).hide(),n.removeClass("ion-refresh fixhub-spin"),e("button.close",s).show(),s.find("input").removeAttr("disabled"),o||app.ConfigFiles.add(i),t.setValue(""),t.gotoLine(1)},error:function(t,a,i){e(".callout-danger",s).show();var o=a.responseJSON;e(".has-error",s).removeClass("has-error"),e(".label-danger",s).remove(),e("form input",s).each(function(t,a){a=e(a);var i=a.attr("name");if(void 0!==o[i]){var n=a.parent("div");n.addClass("has-error"),n.append(e("<span>").attr("class","label label-danger").text(o[i]))}}),n.removeClass("ion-refresh fixhub-spin"),e("button.close",s).show(),s.find("input").removeAttr("disabled")}})}),app.ConfigFile=Backbone.Model.extend({urlRoot:"/config-file"});var i=Backbone.Collection.extend({model:app.ConfigFile});app.ConfigFiles=new i,app.ConfigFilesTab=Backbone.View.extend({el:"#app",events:{},initialize:function(){this.$list=e("#configfile_list tbody"),e("#no_configfiles").show(),e("#configfile_list").hide(),this.listenTo(app.ConfigFiles,"add",this.addOne),this.listenTo(app.ConfigFiles,"reset",this.addAll),this.listenTo(app.ConfigFiles,"remove",this.addAll),this.listenTo(app.ConfigFiles,"all",this.render),app.listener.on("configfile:Fixhub\\Bus\\Events\\ModelChangedEvent",function(e){var t=app.ConfigFiles.get(parseInt(e.model.id));t&&t.set(e.model)}),app.listener.on("configfile:Fixhub\\Bus\\Events\\ModelCreatedEvent",function(t){var a=e('input[name="targetable_type"]').val(),i=e('input[name="targetable_id"]').val();a==t.model.targetable_type&&parseInt(t.model.targetable_id)===parseInt(i)&&app.ConfigFiles.add(t.model)}),app.listener.on("configfile:Fixhub\\Bus\\Events\\ModelTrashedEvent",function(e){var t=app.ConfigFiles.get(parseInt(e.model.id));t&&app.ConfigFiles.remove(t)})},render:function(){app.ConfigFiles.length?(e("#no_configfiles").hide(),e("#configfile_list").show()):(e("#no_configfiles").show(),e("#configfile_list").hide())},addOne:function(e){var t=new app.ConfigFileView({model:e});this.$list.append(t.render().el)},addAll:function(){this.$list.html(""),app.ConfigFiles.each(this.addOne,this)}}),app.ConfigFileView=Backbone.View.extend({tagName:"tr",events:{"click .btn-edit":"edit","click .btn-delete":"trash","click .btn-view":"view"},initialize:function(){this.listenTo(this.model,"change",this.render),this.listenTo(this.model,"destroy",this.remove),this.template=_.template(e("#configfiles-template").html())},render:function(){var e=this.model.toJSON();return this.$el.html(this.template(e)),this},view:function(){a=this.model.get("path"),e("#preview-content").text(this.model.get("content"))},edit:function(){e("#config_file_id").val(this.model.id),e("#name").val(this.model.get("name")),e("#path").val(this.model.get("path")),e("#content").text(this.model.get("content"))},trash:function(){var t=e("#model_id");t.val(this.model.id),t.parents(".modal").removeClass().addClass("modal fade configfile-trash")}})}(jQuery);var app=app||{};!function(e){e("#environment_list table").sortable({containerSelector:"table",itemPath:"> tbody",itemSelector:"tr",placeholder:'<tr class="placeholder"/>',delay:500,onDrop:function(t,a,i){i(t,a);var n=[];e("tbody tr td:first-child",a.el[0]).each(function(t,a){n.push(e(a).data("environment-id"))}),e.ajax({url:"/environments/reorder",method:"POST",data:{environments:n}})}}),e("#environment").on("show.bs.modal",function(t){var a=e(t.relatedTarget),i=e(this),n=trans("environments.create");e(".btn-danger",i).hide(),e(".callout-danger",i).hide(),e(".has-error",i).removeClass("has-error"),e(".label-danger",i).remove(),e("#add-environment-command",i).hide(),a.hasClass("btn-edit")?(n=trans("environments.edit"),e(".btn-danger",i).show()):(e("#environment_id").val(""),e("#environment_name").val(""),e("#environment_description").val(""),e("#environment_default_on").prop("checked",!0),e("#add-environment-command",i).show()),i.find(".modal-title span").text(n)}),e("body").delegate(".environment-trash button.btn-delete","click",function(t){var a=e(t.currentTarget),i=a.find("i"),n=a.parents(".modal");i.addClass("ion-refresh fixhub-spin"),n.find("input").attr("disabled","disabled"),e("button.close",n).hide(),app.Environments.get(e("#model_id").val()).destroy({wait:!0,success:function(t,a,s){n.modal("hide"),e(".callout-danger",n).hide(),i.removeClass("ion-refresh fixhub-spin"),e("button.close",n).show(),n.find("input").removeAttr("disabled")},error:function(){i.removeClass("ion-refresh fixhub-spin"),e("button.close",n).show(),n.find("input").removeAttr("disabled")}})}),e("#environment button.btn-save").on("click",function(t){var a=e(t.currentTarget),i=a.find("i"),n=a.parents(".modal");i.addClass("ion-refresh fixhub-spin"),n.find("input").attr("disabled","disabled"),e("button.close",n).hide();var s=e("#environment_id").val();if(s)var o=app.Environments.get(s);else var o=new app.Environment;o.save({name:e("#environment_name").val(),description:e("#environment_description").val(),default_on:e("#environment_default_on").is(":checked"),targetable_type:e('input[name="targetable_type"]').val(),targetable_id:e('input[name="targetable_id"]').val(),add_commands:e("#environment_commands").is(":checked")},{wait:!0,success:function(t,a,o){n.modal("hide"),e(".callout-danger",n).hide(),i.removeClass("ion-refresh fixhub-spin"),e("button.close",n).show(),n.find("input").removeAttr("disabled"),s||app.Environments.add(a)},error:function(t,a,s){e(".callout-danger",n).show();var o=a.responseJSON;e(".has-error",n).removeClass("has-error"),e(".label-danger",n).remove(),e("form input",n).each(function(t,a){a=e(a);var i=a.attr("name");if(void 0!==o[i]){var n=a.parent("div");n.addClass("has-error"),n.append(e("<span>").attr("class","label label-danger").text(o[i]))}}),i.removeClass("ion-refresh fixhub-spin"),e("button.close",n).show(),n.find("input").removeAttr("disabled")}})}),app.Environment=Backbone.Model.extend({urlRoot:"/environments",initialize:function(){}});var t=Backbone.Collection.extend({model:app.Environment});app.Environments=new t,app.EnvironmentsTab=Backbone.View.extend({el:"#app",events:{},initialize:function(){this.$list=e("#environment_list tbody"),e("#no_environments").show(),e("#environment_list").hide(),this.listenTo(app.Environments,"add",this.addOne),this.listenTo(app.Environments,"reset",this.addAll),this.listenTo(app.Environments,"remove",this.addAll),this.listenTo(app.Environments,"all",this.render),app.listener.on("environment:Fixhub\\Bus\\Events\\ModelChangedEvent",function(t){e("#environment_"+t.model.id).html(t.model.name);var a=app.Environments.get(parseInt(t.model.id));a&&a.set(t.model)}),app.listener.on("environment:Fixhub\\Bus\\Events\\ModelCreatedEvent",function(t){var a=e('input[name="targetable_type"]').val(),i=e('input[name="targetable_id"]').val();a==t.model.targetable_type&&parseInt(t.model.targetable_id)===parseInt(i)&&app.Environments.add(t.model)}),app.listener.on("environment:Fixhub\\Bus\\Events\\ModelTrashedEvent",function(e){var t=app.Environments.get(parseInt(e.model.id));t&&app.Environments.remove(t)})},render:function(){app.Environments.length?(e("#no_environments").hide(),e("#environment_list").show()):(e("#no_environments").show(),e("#environment_list").hide())},addOne:function(t){var a=new app.EnvironmentView({model:t});this.$list.append(a.render().el),app.Environments.length<2?e(".drag-handle",this.$list).hide():e(".drag-handle",this.$list).show()},addAll:function(){this.$list.html(""),app.Environments.each(this.addOne,this)}}),app.EnvironmentView=Backbone.View.extend({tagName:"tr",events:{"click .btn-edit":"edit","click .btn-delete":"trash"},initialize:function(){this.listenTo(this.model,"change",this.render),this.listenTo(this.model,"destroy",this.remove),this.template=_.template(e("#environment-template").html())},render:function(){var e=this.model.toJSON();return e.last_run=null!=e.last_run?moment(e.last_run).fromNow():trans("app.never"),this.$el.html(this.template(e)),this},edit:function(){e("#environment_id").val(this.model.id),e("#environment_name").val(this.model.get("name")),e("#environment_description").val(this.model.get("description")),e("#environment_default_on").prop("checked",!0===this.model.get("default_on"))},trash:function(){var t=e("#model_id");t.val(this.model.id),t.parents(".modal").removeClass().addClass("modal fade environment-trash")}})}(jQuery);var app=app||{};!function(e){e("#sharedfile").on("show.bs.modal",function(t){var a=e(t.relatedTarget),i=e(this),n=trans("sharedFiles.create");e(".btn-danger",i).hide(),e(".callout-danger",i).hide(),e(".has-error",i).removeClass("has-error"),e(".label-danger",i).remove(),a.hasClass("btn-edit")?(n=trans("sharedFiles.edit"),e(".btn-danger",i).show()):(e("#sharedfile_id").val(""),e("#name").val(""),e("#file").val("")),i.find(".modal-title span").text(n)}),e("body").delegate(".sharedfile-trash button.btn-delete","click",function(t){var a=e(t.currentTarget),i=a.find("i"),n=a.parents(".modal");i.addClass("ion-refresh fixhub-spin"),n.find("input").attr("disabled","disabled"),e("button.close",n).hide(),app.SharedFiles.get(e("#model_id").val()).destroy({wait:!0,success:function(t,a,s){n.modal("hide"),e(".callout-danger",n).hide(),i.removeClass("ion-refresh fixhub-spin"),e("button.close",n).show(),n.find("input").removeAttr("disabled")},error:function(){i.removeClass("ion-refresh fixhub-spin"),e("button.close",n).show(),n.find("input").removeAttr("disabled")}})}),e("#sharedfile button.btn-save").on("click",function(t){var a=e(t.currentTarget),i=a.find("i"),n=a.parents(".modal");i.addClass("ion-refresh fixhub-spin"),n.find("input").attr("disabled","disabled"),e("button.close",n).hide();var s=e("#sharedfile_id").val();if(s)var o=app.SharedFiles.get(s);else var o=new app.SharedFile;o.save({name:e("#name").val(),file:e("#file").val(),targetable_type:e('input[name="targetable_type"]').val(),targetable_id:e('input[name="targetable_id"]').val()},{wait:!0,success:function(t,a,o){n.modal("hide"),e(".callout-danger",n).hide(),i.removeClass("ion-refresh fixhub-spin"),e("button.close",n).show(),n.find("input").removeAttr("disabled"),s||app.SharedFiles.add(a)},error:function(t,a,s){e(".callout-danger",n).show();var o=a.responseJSON;e(".has-error",n).removeClass("has-error"),e(".label-danger",n).remove(),e("form input",n).each(function(t,a){a=e(a);var i=a.attr("name");if(void 0!==o[i]){var n=a.parent("div");n.addClass("has-error"),n.append(e("<span>").attr("class","label label-danger").text(o[i]))}}),i.removeClass("ion-refresh fixhub-spin"),e("button.close",n).show(),n.find("input").removeAttr("disabled")}})}),app.SharedFile=Backbone.Model.extend({urlRoot:"/shared-files"});var t=Backbone.Collection.extend({model:app.SharedFile});app.SharedFiles=new t,app.SharedFilesTab=Backbone.View.extend({el:"#app",events:{},initialize:function(){this.$list=e("#sharedfile_list tbody"),e("#no_sharedfiles").show(),e("#sharedfile_list").hide(),this.listenTo(app.SharedFiles,"add",this.addOne),this.listenTo(app.SharedFiles,"reset",this.addAll),this.listenTo(app.SharedFiles,"remove",this.addAll),this.listenTo(app.SharedFiles,"all",this.render),app.listener.on("sharedfile:Fixhub\\Bus\\Events\\ModelChangedEvent",function(e){var t=app.SharedFiles.get(parseInt(e.model.id));t&&t.set(e.model)}),app.listener.on("sharedfile:Fixhub\\Bus\\Events\\ModelCreatedEvent",function(t){var a=e('input[name="targetable_type"]').val(),i=e('input[name="targetable_id"]').val();a==t.model.targetable_type&&parseInt(t.model.targetable_id)===parseInt(i)&&app.SharedFiles.add(t.model)}),app.listener.on("sharedfile:Fixhub\\Bus\\Events\\ModelTrashedEvent",function(e){var t=app.SharedFiles.get(parseInt(e.model.id));t&&app.SharedFiles.remove(t)})},render:function(){app.SharedFiles.length?(e("#no_sharedfiles").hide(),e("#sharedfile_list").show()):(e("#no_sharedfiles").show(),e("#sharedfile_list").hide())},addOne:function(e){var t=new app.SharedFileView({model:e});this.$list.append(t.render().el)},addAll:function(){this.$list.html(""),app.SharedFiles.each(this.addOne,this)}}),app.SharedFileView=Backbone.View.extend({tagName:"tr",events:{"click .btn-edit":"edit","click .btn-delete":"trash"},initialize:function(){this.listenTo(this.model,"change",this.render),this.listenTo(this.model,"destroy",this.remove),this.template=_.template(e("#sharedfile-template").html())},render:function(){var e=this.model.toJSON();return this.$el.html(this.template(e)),this},edit:function(){e("#sharedfile_id").val(this.model.id),e("#name").val(this.model.get("name")),e("#file").val(this.model.get("file"))},trash:function(){var t=e("#model_id");t.val(this.model.id),t.parents(".modal").removeClass().addClass("modal fade sharedfile-trash")}})}(jQuery);var app=app||{};!function(e){e("#variable").on("show.bs.modal",function(t){var a=e(t.relatedTarget),i=e(this),n=trans("variables.create");e(".btn-danger",i).hide(),e(".callout-danger",i).hide(),e(".has-error",i).removeClass("has-error"),e(".label-danger",i).remove(),a.hasClass("btn-edit")?(n=trans("variables.edit"),e(".btn-danger",i).show()):(e("#variable_id").val(""),e("#variable_name").val(""),e("#variable_value").val("")),i.find(".modal-title span").text(n)}),e("body").delegate(".variable-trash button.btn-delete","click",function(t){var a=e(t.currentTarget),i=a.find("i"),n=a.parents(".modal");i.addClass("ion-refresh fixhub-spin"),n.find("input").attr("disabled","disabled"),e("button.close",n).hide(),app.Variables.get(e("#model_id").val()).destroy({wait:!0,success:function(t,a,s){n.modal("hide"),e(".callout-danger",n).hide(),i.removeClass("ion-refresh fixhub-spin"),e("button.close",n).show(),n.find("input").removeAttr("disabled")},error:function(){i.removeClass("ion-refresh fixhub-spin"),e("button.close",n).show(),n.find("input").removeAttr("disabled")}})}),e("#variable button.btn-save").on("click",function(t){var a=e(t.currentTarget),i=a.find("i"),n=a.parents(".modal");i.addClass("ion-refresh fixhub-spin"),n.find("input").attr("disabled","disabled"),e("button.close",n).hide();var s=e("#variable_id").val();if(s)var o=app.Variables.get(s);else var o=new app.Variable;o.save({name:e("#variable_name").val(),value:e("#variable_value").val(),targetable_type:e('input[name="targetable_type"]').val(),targetable_id:e('input[name="targetable_id"]').val()},{wait:!0,success:function(t,a,o){n.modal("hide"),e(".callout-danger",n).hide(),i.removeClass("ion-refresh fixhub-spin"),e("button.close",n).show(),n.find("input").removeAttr("disabled"),s||app.Variables.add(a)},error:function(t,a,s){e(".callout-danger",n).show();var o=a.responseJSON;e(".has-error",n).removeClass("has-error"),e(".label-danger",n).remove(),e("form input",n).each(function(t,a){a=e(a);var i=a.attr("name");if(void 0!==o[i]){var n=a.parent("div");n.addClass("has-error"),n.append(e("<span>").attr("class","label label-danger").text(o[i]))}}),i.removeClass("ion-refresh fixhub-spin"),e("button.close",n).show(),n.find("input").removeAttr("disabled")}})}),app.Variable=Backbone.Model.extend({urlRoot:"/variables",initialize:function(){}});var t=Backbone.Collection.extend({model:app.Variable});app.Variables=new t,app.VariablesTab=Backbone.View.extend({el:"#app",events:{},initialize:function(){this.$list=e("#variable_list tbody"),e("#no_variables").show(),e("#variable_list").hide(),this.listenTo(app.Variables,"add",this.addOne),this.listenTo(app.Variables,"reset",this.addAll),this.listenTo(app.Variables,"remove",this.addAll),this.listenTo(app.Variables,"all",this.render),app.listener.on("variable:Fixhub\\Bus\\Events\\ModelChangedEvent",function(t){e("#variable_"+t.model.id).html(t.model.name);var a=app.Variables.get(parseInt(t.model.id));a&&a.set(t.model)}),app.listener.on("variable:Fixhub\\Bus\\Events\\ModelCreatedEvent",function(t){var a=e('input[name="targetable_type"]').val(),i=e('input[name="targetable_id"]').val();a==t.model.targetable_type&&parseInt(t.model.targetable_id)===parseInt(i)&&app.Variables.add(t.model)}),app.listener.on("variable:Fixhub\\Bus\\Events\\ModelTrashedEvent",function(e){var t=app.Variables.get(parseInt(e.model.id));t&&app.Variables.remove(t)})},render:function(){app.Variables.length?(e("#no_variables").hide(),e("#variable_list").show()):(e("#no_variables").show(),e("#variable_list").hide())},addOne:function(e){var t=new app.VariableView({model:e});this.$list.append(t.render().el)},addAll:function(){this.$list.html(""),app.Variables.each(this.addOne,this)}}),app.VariableView=Backbone.View.extend({tagName:"tr",events:{"click .btn-edit":"edit","click .btn-delete":"trash"},initialize:function(){this.listenTo(this.model,"change",this.render),this.listenTo(this.model,"destroy",this.remove),this.template=_.template(e("#variable-template").html())},render:function(){var e=this.model.toJSON();return this.$el.html(this.template(e)),this},edit:function(){e("#variable_id").val(this.model.id),e("#variable_name").val(this.model.get("name")),e("#variable_value").val(this.model.get("value"))},trash:function(){var t=e("#model_id");t.val(this.model.id),t.parents(".modal").removeClass().addClass("modal fade variable-trash")}})}(jQuery);